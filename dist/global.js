(()=>{class t{#t;#e;constructor(t,e){this.#t=t,this.#e=Object.assign({canToggle:()=>!0},e)}show(){if(this.#t.matches(":modal")||!this.#e.canToggle?.())return;let t=new AbortController;this.#t.showModal(),this.#e.lightDismiss&&(this.#t.addEventListener("click",t=>{!(t instanceof MouseEvent)||function(t,e){let{clientX:i,clientY:s}=t,o=t.target,{x:l,y:n,width:g,height:a}=e.getBoundingClientRect();return e===o?i>=l&&i<=l+g&&s>=n&&s<=n+a:e.contains(o)}(t,this.#t)||this.#t.close()},{signal:t.signal}),setTimeout(()=>{this.#t.getRootNode().addEventListener("click",t=>{t.target instanceof Node&&this.#t.contains(t.target)&&this.#t.close()},{signal:t.signal}),this.#t.addEventListener("close",()=>t.abort(),{signal:t.signal})},0)),this.#e.onToggle?.()}hide(){!this.#t.matches(":not(:modal)")&&this.#e.canToggle?.()&&(this.#t.close(),this.#e.onToggle?.())}toggle(){this.#t.matches(":modal")?this.hide():this.show()}}class e extends HTMLElement{#i=null;#s="toggle";#o=!1;#l;static observedAttributes=["target","target-action","light-dismiss"];attributeChangedCallback(e,i,s){if("target"===e&&(this.#i=s||null),"target-action"===e&&s&&["toggle","show","hide"].includes(s)&&(this.#s=s),"light-dismiss"===e&&(this.#o=void 0!==s),"target"===e||"light-dismiss"===e){let e=this.getRootNode(),{targetElement:i}=this;i instanceof HTMLDialogElement&&(e instanceof Document||e instanceof ShadowRoot)&&(this.#l=new t(i,{lightDismiss:this.#o,canToggle:()=>this.#n(),onToggle:()=>this.#g()}))}}get target(){return this.#i}set target(t){this.#i=t,null===t?this.removeAttribute("target"):this.setAttribute("target",t)}get targetAction(){return this.#s}set targetAction(t){t&&(this.#s=t,null===t?this.removeAttribute("target-action"):this.setAttribute("target-action",t))}get lightDismiss(){return this.#o}set lightDismiss(t){this.#o=!!t,this.#o?this.setAttribute("light-dismiss",""):this.removeAttribute("light-dismiss")}get targetElement(){let t=this.getRootNode(),e=this.target?t.getElementById(this.target):null;return e instanceof HTMLDialogElement?e:null}connectedCallback(){this.addEventListener("click",this.#a)}disconnectedCallback(){this.removeEventListener("click",this.#a)}#n(){return this.dispatchEvent(new Event("modal-control-before-toggle",{cancelable:!0}))}#g(){return this.dispatchEvent(new Event("modal-control-toggle"))}#a=t=>{let e=t.target;if(e.closest('button, input[type="button"]'))switch(this.targetAction){case"show":this.#l?.show();break;case"hide":this.#l?.hide();break;case"toggle":this.#l?.toggle()}}}((t="modal-control")=>{"customElements"in window&&customElements.define(t,e)})()})();
//# sourceMappingURL=global.js.map
