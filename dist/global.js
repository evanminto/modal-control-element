(()=>{function t(e,i){if(e.contains(i))return!0;let s=i.getRootNode();return s instanceof ShadowRoot&&t(e,s.host)}function e(e,i){let{clientX:s,clientY:o}=e,n=e.target,{x:l,y:g,width:a,height:r}=i.getBoundingClientRect();return i===n?s>=l&&s<=l+a&&o>=g&&o<=g+r:t(i,n)}class i{#t;#e;constructor(t,e){this.#t=t,this.#e=Object.assign({canToggle:()=>!0},e)}show(){let i=this.#i();if(!i||i.matches(":modal")||!this.#e.canToggle?.())return;let s=new AbortController;i.showModal(),this.#e.lightDismiss&&(i.addEventListener("click",t=>{!(t instanceof MouseEvent)||e(t,i)||this.hide()},{signal:s.signal}),setTimeout(()=>{let o=i.getRootNode(),n=t=>{!(t instanceof MouseEvent)||e(t,i)||this.hide()};o instanceof ShadowRoot?(o.addEventListener("click",n,{signal:s.signal}),i.getRootNode({composed:!0}).addEventListener("click",e=>{!(e.target instanceof Node)||t(e.target,i)||this.hide()},{signal:s.signal})):o.addEventListener("click",n,{signal:s.signal}),i.addEventListener("close",()=>s.abort(),{signal:s.signal})},0)),this.#e.onToggle?.()}hide(){let t=this.#i();!(!t||t.matches(":not(:modal)"))&&this.#e.canToggle?.()&&(t.close(),this.#e.onToggle?.())}toggle(){this.#i()?.matches(":modal")?this.hide():this.show()}#i(){return"function"==typeof this.#t?this.#t():this.#t}}class s extends HTMLElement{#s=null;#o="toggle";#n=!1;#l;static observedAttributes=["target","target-action","light-dismiss"];attributeChangedCallback(t,e,i){"target"===t&&(this.#s=i||null),"target-action"===t&&i&&["toggle","show","hide"].includes(i)&&(this.#o=i),"light-dismiss"===t&&(this.#n=void 0!==i),("target"===t||"light-dismiss"===t)&&this.#g()}get target(){return this.#s}set target(t){this.#s=t,null===t?this.removeAttribute("target"):this.setAttribute("target",t)}get targetAction(){return this.#o}set targetAction(t){t&&(this.#o=t,null===t?this.removeAttribute("target-action"):this.setAttribute("target-action",t))}get lightDismiss(){return this.#n}set lightDismiss(t){this.#n=!!t,this.#n?this.setAttribute("light-dismiss",""):this.removeAttribute("light-dismiss")}get targetElement(){let t=this.getRootNode(),e=this.target?t.getElementById?.(this.target)??null:null;return e instanceof HTMLDialogElement?e:null}connectedCallback(){this.addEventListener("click",this.#a),this.#g()}disconnectedCallback(){this.removeEventListener("click",this.#a)}#g(){let t=this.getRootNode();(t instanceof Document||t instanceof ShadowRoot)&&(this.#l=new i(()=>this.targetElement,{lightDismiss:this.#n,canToggle:()=>this.#r(),onToggle:()=>this.#h()}))}#r(){return this.dispatchEvent(new Event("modal-control-before-toggle",{cancelable:!0}))}#h(){return this.dispatchEvent(new Event("modal-control-toggle"))}#a=t=>{let e=t.target;if(e.closest('button, input[type="button"]'))switch(this.targetAction){case"show":this.#l?.show();break;case"hide":this.#l?.hide();break;case"toggle":this.#l?.toggle()}}}((t="modal-control")=>{"customElements"in window&&customElements.define(t,s)})()})();
//# sourceMappingURL=global.js.map
